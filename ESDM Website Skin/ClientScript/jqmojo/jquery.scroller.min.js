//misc functions
function watermarkEnter(obj,wm){if(obj.value==wm){obj.value='';obj.style.color='';obj.select();}}
function watermarkLeave(obj,wm){if(obj.value==''){obj.value=wm;}}
function CanHaveClass__CssFriendlyAdapters(element)
{return((element!=null)&&(element.className!=null));}
function HasAnyClass__CssFriendlyAdapters(element)
{return(CanHaveClass__CssFriendlyAdapters(element)&&(element.className.length>0));}
function HasClass__CssFriendlyAdapters(element,specificClass)
{return(HasAnyClass__CssFriendlyAdapters(element)&&(element.className.indexOf(specificClass)>-1));}
function AddClass__CssFriendlyAdapters(element,classToAdd)
{if(HasAnyClass__CssFriendlyAdapters(element))
{if(!HasClass__CssFriendlyAdapters(element,classToAdd))
{element.className=element.className+" "+classToAdd;}}
else if(CanHaveClass__CssFriendlyAdapters(element))
{element.className=classToAdd;}}
function AddClassUpward__CssFriendlyAdapters(startElement,stopParentClass,classToAdd)
{var elementOrParent=startElement;while((elementOrParent!=null)&&(!HasClass__CssFriendlyAdapters(elementOrParent,topmostClass)))
{AddClass__CssFriendlyAdapters(elementOrParent,classToAdd);elementOrParent=elementOrParent.parentNode;}}
function SwapClass__CssFriendlyAdapters(element,oldClass,newClass)
{if(HasAnyClass__CssFriendlyAdapters(element))
{element.className=element.className.replace(new RegExp(oldClass,"gi"),newClass);}}
function SwapOrAddClass__CssFriendlyAdapters(element,oldClass,newClass)
{if(HasClass__CssFriendlyAdapters(element,oldClass))
{SwapClass__CssFriendlyAdapters(element,oldClass,newClass);}
else
{AddClass__CssFriendlyAdapters(element,newClass);}}
function RemoveClass__CssFriendlyAdapters(element,classToRemove)
{SwapClass__CssFriendlyAdapters(element,classToRemove,"");}
function RemoveClassUpward__CssFriendlyAdapters(startElement,stopParentClass,classToRemove)
{var elementOrParent=startElement;while((elementOrParent!=null)&&(!HasClass__CssFriendlyAdapters(elementOrParent,topmostClass)))
{RemoveClass__CssFriendlyAdapters(elementOrParent,classToRemove);elementOrParent=elementOrParent.parentNode;}}
function IsEnterKey()
{var retVal=false;var keycode=0;if((typeof(window.event)!="undefined")&&(window.event!=null))
{keycode=window.event.keyCode;}
else if((typeof(e)!="undefined")&&(e!=null))
{keycode=e.which;}
if(keycode==13)
{retVal=true;}
return retVal;}
var hoverClass="AspNet-Menu-Hover";var topmostClass="AspNet-Menu";var userAgent=navigator.userAgent;var versionOffset=userAgent.indexOf("MSIE");var isIE=(versionOffset>=0);var isPreIE7=false;var fullVersionIE="";var majorVersionIE="";if(isIE)
{fullVersionIE=parseFloat(userAgent.substring(versionOffset+5,userAgent.length));majorVersionIE=parseInt(''+fullVersionIE);isPreIE7=majorVersionIE<7;}
function Hover__AspNetMenu(element)
{AddClass__CssFriendlyAdapters(element,hoverClass);if(isPreIE7)
{var child=element.firstChild;while(child)
{if(child.tagName=="UL")
{var grandchild=child.firstChild;while(grandchild)
{if(grandchild.tagName=="LI")
{if((typeof(grandchild.iFrameFormElementMask)!="undefined")&&(grandchild.iFrameFormElementMask!=null))
{grandchild.iFrameFormElementMask.style.display="block";var w=grandchild.offsetWidth;if((grandchild.offsetWidth==0)&&(typeof(element.iFrameFormElementMask)!="undefined")&&(element.iFrameFormElementMask!=null)&&(element.iFrameFormElementMask.style.width.length>0))
{w=element.iFrameFormElementMask.style.width;}
grandchild.iFrameFormElementMask.style.width=w;var h=grandchild.offsetHeight+5;if((grandchild.offsetHeight==0)&&(typeof(element.iFrameFormElementMask)!="undefined")&&(element.iFrameFormElementMask!=null)&&(element.iFrameFormElementMask.style.height.length>0))
{h=element.iFrameFormElementMask.style.height;}
grandchild.iFrameFormElementMask.style.height=h;}}
grandchild=grandchild.nextSibling;}}
child=child.nextSibling;}}}
function Unhover__AspNetMenu(element)
{RemoveClass__CssFriendlyAdapters(element,hoverClass);if(isPreIE7)
{var child=element.firstChild;while(child)
{if(child.tagName=="UL")
{var grandchild=child.firstChild;while(grandchild)
{if(grandchild.tagName=="LI")
{if((typeof(grandchild.iFrameFormElementMask)!="undefined")&&(grandchild.iFrameFormElementMask!=null))
{grandchild.iFrameFormElementMask.style.display="none";}}
grandchild=grandchild.nextSibling;}}
child=child.nextSibling;}}}
function SetHover__AspNetMenu()
{var menus=document.getElementsByTagName("ul");for(var i=0;i<menus.length;i++)
{if(menus[i].className==topmostClass)
{var items=menus[i].getElementsByTagName("li");for(var k=0;k<items.length;k++)
{items[k].onmouseover=function(){Hover__AspNetMenu(this);}
items[k].onmouseout=function(){Unhover__AspNetMenu(this);}
if(isPreIE7&&((typeof(items[k].iFrameFormElementMask)=="undefined")||(items[k].iFrameFormElementMask==null)))
{var iFrameFormElementMask=document.createElement("IFRAME");iFrameFormElementMask.scrolling="no";iFrameFormElementMask.src="javascript:false;";iFrameFormElementMask.frameBorder=0;iFrameFormElementMask.style.display="none";iFrameFormElementMask.style.position="absolute";iFrameFormElementMask.style.filter="progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)";iFrameFormElementMask.style.zIndex=-1;items[k].insertBefore(iFrameFormElementMask,items[k].firstChild);items[k].iFrameFormElementMask=iFrameFormElementMask;}}}}}
if(isPreIE7)
{window.onload=SetHover__AspNetMenu;}
var collapseClass="AspNet-TreeView-Collapse";var expandClass="AspNet-TreeView-Expand";var showClass="AspNet-TreeView-Show";var hideClass="AspNet-TreeView-Hide";function IsExpanded__AspNetTreeView(element)
{return(HasClass__CssFriendlyAdapters(element,collapseClass));}
function TogglePlusMinus__AspNetTreeView(element,showPlus)
{if(HasAnyClass__CssFriendlyAdapters(element))
{var showPlusLocal=IsExpanded__AspNetTreeView(element);if((typeof(showPlus)!="undefined")&&(showPlus!=null))
{showPlusLocal=showPlus;}
var oldClass=showPlusLocal?collapseClass:expandClass;var newClass=showPlusLocal?expandClass:collapseClass;SwapClass__CssFriendlyAdapters(element,oldClass,newClass);}}
function ToggleChildrenDisplay__AspNetTreeView(element,collapse)
{if((element!=null)&&(element.parentNode!=null)&&(element.parentNode.getElementsByTagName!=null))
{var childrenToHide=element.parentNode.getElementsByTagName("ul");var oldClass=collapse?showClass:hideClass;var newClass=collapse?hideClass:showClass;for(var i=0;i<childrenToHide.length;i++)
{if((childrenToHide[i].parentNode!=null)&&(childrenToHide[i].parentNode==element.parentNode))
{SwapOrAddClass__CssFriendlyAdapters(childrenToHide[i],oldClass,newClass);}}}}
function ExpandCollapse__AspNetTreeView(sourceElement)
{if(HasAnyClass__CssFriendlyAdapters(sourceElement))
{var expanded=IsExpanded__AspNetTreeView(sourceElement);TogglePlusMinus__AspNetTreeView(sourceElement,expanded);ToggleChildrenDisplay__AspNetTreeView(sourceElement,expanded);}}
function GetViewState__AspNetTreeView(id)
{var retStr="";if((typeof(id)!="undefined")&&(id!=null)&&(document.getElementById(id)!=null))
{var topUL=document.getElementById(id);retStr=ComposeViewState__AspNetTreeView(topUL,"");}
return retStr;}
function ComposeViewState__AspNetTreeView(element,state)
{var child=element.firstChild;var bConsiderChildren=true;if((element.tagName=="LI")&&(child!=null))
{var expandCollapseSPAN=null;var currentChild=child;while(currentChild!=null)
{if((currentChild.tagName=="SPAN")&&(currentChild.className!=null)&&((currentChild.className.indexOf(collapseClass)>-1)||(currentChild.className.indexOf(expandClass)>-1)))
{expandCollapseSPAN=currentChild;break;}
currentChild=currentChild.nextSibling;}
if(expandCollapseSPAN!=null)
{if(expandCollapseSPAN.className.indexOf(collapseClass)>-1)
{state+="e";}
else if(expandCollapseSPAN.className.indexOf(expandClass)>-1)
{bConsiderChildren=false;state+="n";}}}
if(bConsiderChildren&&(child!=null))
{state=ComposeViewState__AspNetTreeView(child,state);}
if(element.nextSibling!=null)
{state=ComposeViewState__AspNetTreeView(element.nextSibling,state);}
return state;}
function trackUserLocation(location){if(location==null){return;}}
function Get_Cookie(check_name){var a_all_cookies=document.cookie.split(';');var a_temp_cookie='';var cookie_name='';var cookie_value='';var b_cookie_found=false;var i='';for(i=0;i<a_all_cookies.length;i++)
{a_temp_cookie=a_all_cookies[i].split('=');cookie_name=a_temp_cookie[0].replace(/^\s+|\s+$/g,'');if(cookie_name==check_name)
{b_cookie_found=true;if(a_temp_cookie.length>1)
{cookie_value=unescape(a_temp_cookie[1].replace(/^\s+|\s+$/g,''));}
return cookie_value;break;}
a_temp_cookie=null;cookie_name='';}
if(!b_cookie_found)
{return null;}}
function Set_Cookie(name,value,expires,path,domain,secure){var today=new Date();today.setTime(today.getTime());if(expires)
{expires=expires*1000*60*60*24;}
var expires_date=new Date(today.getTime()+(expires));document.cookie=name+"="+escape(value)+
((expires)?";expires="+expires_date.toGMTString():"")+
((path)?";path="+path:"")+
((domain)?";domain="+domain:"")+
((secure)?";secure":"");}
function Delete_Cookie(name,path,domain){if(Get_Cookie(name))document.cookie=name+"="+
((path)?";path="+path:"")+
((domain)?";domain="+domain:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT";}
/* jQuery Scroller plugin
	Copyright (c) 2010 Max Vergelli

	For support and tutorials visit
	http://maxvergelli.wordpress.com/

	License: GNU Lesser General Public License (LGPL) 
	at http://opensource.org/licenses/lgpl-2.1.php

	This plugin is free software;  you can redistribute it  and/or  modify  it 
	under the terms of the GNU Lesser General Public License as  published  by 
	the Free Software Foundation;  either version 2.1 of the License,  or  (at 
	your option) any later version.
	This software is distributed in the hope  that  it  will  be  useful,  but 
	WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY 
	or FITNESS FOR A PARTICULAR PURPOSE.  See the  GNU Lesser  General  Public 
	License for more details.
	You should have received a copy of  the  GNU Lesser General Public License 
	along with this library;  if not,  write to the  Free Software Foundation, 
	Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA

	THIS COMMENT AND COPYRIGHT NOTICE MUST BE RETAINED IN THE CODE AS IS FOR LEGAL USE
*/
eval(function(p,a,c,k,e,r){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--)r[e(c)]=k[c]||e(c);k=[function(e){return r[e]}];e=function(){return'\\w+'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('(6($){$.N.1k=6(){5.8().9();5.8().r(\'7\',[\'R\'])};$.N.1l=6(){5.8().9()};$.N.1m=6(a){5.8().9();5.8().V(\'7\');a=$.W(5.X(),a);5.Y(a)};$.N.1n=6(){5.8().9();5.8().w({s:0,t:0});5.8().V(\'7\')};$.N.Y=6(h){4 x={y:5};h=$.W({S:Z,10:\'11\',12:\'B\',P:\'1o\',13:\'T\',14:\'1p\',15:\'O\',16:\'O\',U:\'1q\'},h);4 i=z h.S==\'17\'?3(h.S):Z;4 j=h.10.E();4 k=h.12.E();4 l=z h.P==\'17\'&&h.P>0?3(h.P):-1;4 m=h.13.E();4 n=h.14.E();4 o=h.15.E();4 p=h.16.E();4 q=h.U.E();x.y.X(h);18();6 18(){x.y.w(\'U\',q);2(j==\'11\'){2(k!=\'B\'&&k!=\'t\'){k=\'B\'};19()}u{2(k!=\'F\'&&k!=\'s\'){k=\'F\'};1a()};2(n==\'O\'){x.y.1b(6(){$(5).8().9();$(5).8().r(\'7\',[\'R\'])})}u{x.y.1b(6(){$(5).8().9()})};2(o==\'O\'){x.y.1c(6(){$(5).8().9();$(5).8().r(\'7\',[\'R\'])})}u{x.y.1c(6(){$(5).8().9()})};2(p!=\'O\'){x.y.8().9()}};6 1a(){x.y.8().1d(\'7\',6(a,c){4 b=$(5);4 d=3(b.G().H());4 e=3(b.H());4 f=3(b.A().s);4 v=i>0&&i<C?(C-i)*C:1e;4 g=3(v*e/C)+v;2(m==\'Q\'){I(k){J\'F\':2(z c==\'D\'){b.w({s:d-e})};d=f-(e+d);K;L:2(z c==\'D\'){b.w({s:0})};d+=f+e}}u{I(k){J\'F\':2(z c==\'D\'){b.w({s:d});d=-e}u{d=f-(e+d)};K;L:2(z c==\'D\'){b.w({s:-e})}u{d+=f+e}}};2(l<0||l>0){2(l>0){l--};b.1f({s:d},{1g:g,1h:\'T\',1i:6(){b.r(\'7\')},1j:6(){I(m){J\'Q\':2(k==\'F\'){2(3(b.A().s)<=0){k=\'s\';b.9();b.r(\'7\')}}u{2(3(b.A().s)+3(b.H())>=3(b.G().H())){k=\'F\';b.9();b.r(\'7\')}};K;L:2(k==\'F\'){2(3(b.A().s)<-3(b.H())){b.9();b.r(\'7\')}}u{2(3(b.A().s)>3(b.G().H())){b.9();b.r(\'7\')}}}}})}}).r(\'7\')};6 19(){x.y.8().1d(\'7\',6(a,c){4 b=$(5);4 d=3(b.G().M());4 e=3(b.M());4 f=3(b.A().t);4 v=i>0&&i<C?(C-i)*C:1e;4 g=3(v*e/C)+v;2(m==\'Q\'){I(k){J\'B\':2(z c==\'D\'){b.w({t:d-e})};d=f-(e+d);K;L:2(z c==\'D\'){b.w({t:0})};d+=f+e}}u{I(k){J\'B\':2(z c==\'D\'){b.w({t:d});d=-e}u{d=f-(e+d)};K;L:2(z c==\'D\'){b.w({t:-e})}u{d+=f+e}}};2(l<0||l>0){2(l>0){l--};b.1f({t:d},{1g:g,1h:\'T\',1i:6(){b.r(\'7\')},1j:6(){I(m){J\'Q\':2(k==\'B\'){2(3(b.A().t)<=0){k=\'t\';b.9();b.r(\'7\')}}u{2(3(b.A().t)+3(b.M())>=3(b.G().M())){k=\'B\';b.9();b.r(\'7\')}};K;L:2(k==\'B\'){2(3(b.A().t)<-3(b.M())){b.9();b.r(\'7\')}}u{2(3(b.A().t)>3(b.G().M())){b.9();b.r(\'7\')}}}}})}}).r(\'7\')};1r 5}})(1s);',62,91,'||if|parseInt|var|this|function|marquee|children|stop||||||||||||||||||trigger|top|left|else||css|_|me|typeof|position|right|100|undefined|toLowerCase|bottom|parent|height|switch|case|break|default|width|fn|play|loop|pingpong|resume|velocity|linear|cursor|unbind|extend|data|SetScroller|50|direction|horizontal|startfrom|movetype|onmouseover|onmouseout|onstartup|number|main|scrollHorizontal|scrollVertical|mouseover|mouseout|bind|5000|animate|duration|easing|complete|step|PlayScroller|PauseScroller|ResetScroller|RemoveScroller|infinite|pause|pointer|return|jQuery'.split('|'),0,{}))
/* page exit prompt */
var exitThisPagePrompt = 'Are you sure you want to leave this page?';
var alreadySetExitPrompt = false;
var requireExitPrompt = false;
var contentDidChange = false;
function goodbye(e) {
    if (!requireExitPrompt) { return; }
    if (!contentDidChange) { return; }
    return exitThisPagePrompt;
}
function hookupGoodbyePrompt(message) {
    contentDidChange = true;
    if ((!alreadySetExitPrompt)&&(requireExitPrompt)) {
        exitThisPagePrompt = message;
        alreadySetExitPrompt = true;
        window.onbeforeunload = goodbye;
    }
}
function unHookGoodbyePrompt() {
    requireExitPrompt = false;
}
/* jquery pinify http://ie9ify.codeplex.com/ */
(function(d,e){function c(f,h,g){if(d("meta[name="+f+"]").length&&f!=="msapplication-task"){return}if(!h.length){return}d("<meta>",{name:f,content:h}).appendTo(g)}function a(){return(!!window.external)&&("msIsSiteMode" in window.external)}var b={init:function(g){var f={applicationName:document.title.toString(),favIcon:"http://"+location.host+"/favicon.ico",navColor:"",startUrl:"http://"+location.host,tooltip:document.title.toString(),window:"width=800;height=600",tasks:[]};g=d.extend({},f,g);return this.each(function(){var i=g.tasks;var h=this;if(d("link[type^=image]").length===0){d("<link />",{rel:"shortcut icon",type:"image/ico",href:g.favIcon}).appendTo(this)}c("application-name",g.applicationName,this);c("msapplication-tooltip",g.tooltip,this);c("msapplication-starturl",g.startUrl,this);c("msapplication-navbutton-color",g.navColor,this);c("msapplication-window",g.window,this);d.each(i,function(j,k){c("msapplication-task","name="+k.name+";action-uri="+k.action+";icon-uri="+k.icon,h)})})},enablePinning:function(f){return this.each(function(){f=f||"Drag this image to your Windows 7 Taskbar to pin this site with IE9";d(this).addClass("msPinSite").attr("title",f)})},enableSiteMode:function(f){f=f||"click";return this.each(function(){d(this).bind(f,function(g){g.preventDefault();try{window.external.msAddSiteMode()}catch(h){}})})},pinTeaser:function(o){if(window.external.msIsSiteMode()){return this}var j=d(this);var i={type:"hangingChad",icon:"http://"+location.host+"/favicon.ico",pinText:"Drag this image to the taskbar to pin this site",secondaryText:"Simply drag the icon or tab to taskbar to pin.",addStartLink:true,linkText:"Click here to add this site to the start menu",sticky:true,timeout:10000,style:{linkColor:"rgb(0, 108, 172)",backgroundColor:"rgb(0, 108, 172)",textColor:"white",backgroundImage:null,leftBackgoundImage:null,rightBackgoundImage:null,closeButtonImage:null}};var m,g,l,f,n,h;var k={topHat:function(){j.addClass("pinify-topHat-container pinify-teaser").css("color",o.style.textColor);if(o.style.backgoundImage){j.css("background-image",o.style.backgroundImage)}m=d("<div>",{"class":"pinify-topHat-alignment"}).appendTo(j);g=d("<div>",{"class":"pinify-topHat-content"}).appendTo(m);d("<img>",{id:"pinify-topHat-logo",src:o.icon,alt:"Drag Me","class":"msPinSite"}).appendTo(g);d("<span>").addClass("pinify-topHat-text").text(o.pinText).appendTo(g)},brandedTopHat:function(){j.addClass("pinify-brandedTopHat-container pinify-teaser").css("color",o.style.textColor);if(o.style.backgoundImage){j.css("background-image",o.style.backgroundImage)}g=d("<div>",{"class":"pinify-brandedTopHat-content"}).appendTo(j);d("<img>",{id:"pinify-brandedTopHat-firstLogo",src:o.icon,alt:"Drag Me","class":"msPinSite"}).appendTo(g);d("<img>",{id:"pinify-brandedTopHat-thirdLogo",src:o.icon,alt:"Drag Me","class":"msPinSite"}).appendTo(g);d("<div>",{"class":"pinify-mainText"}).text(o.pinText).appendTo(g);d("<div>",{"class":"pinify-brandedTopHat-secondaryText"}).text(o.secondaryText).appendTo(g)},doubleTopHat:function(){j.addClass("pinify-doubleTopHat-container pinify-teaser").css("color",o.style.textColor);l=d("<div>",{"class":"pinify-doubleTopHat-left"}).appendTo(j);if(o.style.leftBackgroundImage){d(l).css("background-image",o.style.leftBackgoundImage)}f=d("<div>",{id:"pinify-doubleTopHat-leftBar"}).appendTo(l);d("<img>",{id:"pinify-doubleTopHat-logo",src:o.icon,alt:"Drag Me","class":"msPinSite"}).appendTo(f);n=d("<div>",{"class":"pinify-doubleTopHat-right"}).appendTo(j);if(o.style.rightBackgroundImage){d(n).css("background-image",o.style.rightBackgoundImage)}d("<div>",{id:"pinify-doubleTopHat-rightBar"}).appendTo(n);h=d("<div>",{id:"pinify-doubleTopHat-rightBarMainContent"}).appendTo(n);d("<div>",{"class":"pinify-mainText"}).text(o.pinText).appendTo(h);d("<div>",{"class":"pinify-doubleTopHat-lighterText"}).text(o.secondaryText).appendTo(n)},hangingChad:function(){j.hide();j.css({color:o.style.textColor,"background-color":o.style.backgroundColor}).addClass("pinify-hanging-container pinify-teaser");d("<img>",{src:o.icon,"class":"msPinSite"}).appendTo(j);d("<div>",{"class":"pinify-hanging-content"}).appendTo(j);d("<div>",{id:"pinify-pinText"}).text(o.pinText).appendTo(j);j.fadeIn("slow")}};o=d.extend({},i,o);return this.each(function(){k[o.type]();if(!o.sticky){this.delay(o.timeout).fadeOut("slow")}else{d("<div>").addClass("pinify-closePin").click(function(){d(".pinify-teaser").slideUp("slow");j.slideUp("slow")}).appendTo(j)}if(!o.addStartLink){return}d("<a>").addClass("pinify-addSiteLink").attr("href","#").click(function(p){p.preventDefault();try{window.external.msAddSiteMode()}catch(q){}}).css("color",o.linkColor).appendTo(j).text(o.linkText)})}};d.fn.pinify=function(f){if(!a()){return this}if(b[f]){return b[f].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof f==="object"||!f){return b.init.apply(this,arguments)}else{d.error("Method "+f+" does not exist on jQuery.pinify")}}};d.pinify={};d.pinify.firstRunState=function(f){if(!a()){return 0}if(f){f=false}try{return window.external.msIsSiteModeFirstRun(f)}catch(g){return 0}};d.pinify.isPinned=function(){if(!a()){return false}try{return window.external.msIsSiteMode()}catch(f){return false}};d.pinify.addJumpList=function(h){if(!a()){return this}var f={title:"",items:[]};h=d.extend({},f,h);try{if(window.external.msIsSiteMode()){window.external.msSiteModeClearJumplist();window.external.msSiteModeCreateJumplist(h.title);var g=h.items;d.each(g,function(j,k){window.external.msSiteModeAddJumpListItem(k.name,k.url,k.icon)});window.external.msSiteModeShowJumplist()}}catch(i){}return this};d.pinify.clearJumpList=function(){if(!a()){return this}try{if(window.external.msIsSiteMode()){window.external.msSiteModeClearJumpList()}}catch(f){}};d.pinify.addOverlay=function(g){if(!a()){return this}var f={eventName:"click",title:"",icon:""};g=d.extend({},f,g);try{if(window.external.msIsSiteMode()){window.external.msSiteModeClearIconOverlay();window.external.msSiteModeSetIconOverlay(g.icon,g.title)}}catch(h){}};d.pinify.clearOverlay=function(){if(!a()){return this}try{if(window.external.msIsSiteMode()){window.external.msSiteModeClearIconOverlay()}}catch(f){}};d.pinify.flashTaskbar=function(f){if(!a()){return this}try{if(window.external.msIsSiteMode()){window.external.msSiteModeActivate()}}catch(g){}};d.pinify.createThumbbarButtons=function(i){if(!a()){return this}var g={buttons:[]};i=d.extend({},g,i);try{if(window.external.msIsSiteMode()){var j=[];var f=function(){};f.prototype.button=null;f.prototype.alternateStyle=null;f.prototype.activeStyle=0;f.prototype.click=null;var h=function(l){var n=j[l.buttonID];n.click();if(n.alternateStyle){var m=n.activeStyle===0?n.alternateStyle:0;window.external.msSiteModeShowButtonStyle(n.button,m);n.activeStyle=m}};d.each(i.buttons,function(m,p){var l=window.external.msSiteModeAddThumbBarButton(p.icon,p.name);var o;if(p.alternateStyle){var n=p.alternateStyle;o=window.external.msSiteModeAddButtonStyle(l,n.icon,n.name)}var q=new f();q.button=l;q.alternateStyle=o;q.click=p.click;j[l]=q;document.addEventListener("msthumbnailclick",h,false)});window.onunload=function(){var l;for(l in j){if(j.hasOwnProperty(l)){window.external.msSiteModeUpdateThumbBarButton(j[l].button,true,false)}}};window.onload=function(){var l;for(l in j){if(j.hasOwnProperty(l)){window.external.msSiteModeUpdateThumbBarButton(j[l].button,true,true)}}};window.external.msSiteModeShowThumbBar()}}catch(k){}}})(jQuery);
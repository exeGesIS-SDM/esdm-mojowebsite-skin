if(Type.registerNamespace("Sys.Extended.UI.HtmlEditor"),Sys.Extended.UI.HtmlEditor.Trim=function(n){return n.replace(/[\x00-\x1F]+/g,"")},Sys.Extended.UI.HtmlEditor.TrimAll=function(n){return n.replace(/[\x00-\x1F]/g,"").replace(/^[\x20]+/g,"").replace(/[\x20]+$/g,"")},Sys.Extended.UI.HtmlEditor.isIE=Sys.Browser.agent==Sys.Browser.InternetExplorer,Sys.Extended.UI.HtmlEditor.isSafari=Sys.Browser.agent==Sys.Browser.Safari,Sys.Extended.UI.HtmlEditor.isOpera=Sys.Browser.agent==Sys.Browser.Opera,Sys.Extended.UI.HtmlEditor.tryReplaceRgb=function(n){function i(n){return n<16?"0"+n.toString(16):n.toString(16)}function r(n,t,r,u,f){var e=parseInt(r),o=parseInt(u),s=parseInt(f);return"#"+i(e)+i(o)+i(s)}var t=n;try{t=t.replace(/(rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\))/ig,r)}catch(u){}return t},Sys.Extended.UI.HtmlEditor._getScrollTop=function(n){var t=n.document,i=0;return typeof n.pageYOffset=="number"&&(i=n.pageYOffset),t.body&&t.body.scrollTop?i=t.body.scrollTop:t.documentElement&&t.documentElement.scrollTop&&(i=t.documentElement.scrollTop),i},Sys.Extended.UI.HtmlEditor._getScrollLeft=function(n){var t=n.document,i=0;return typeof n.pageXOffset=="number"?i=n.pageXOffset:t.body&&t.body.scrollLeft?i=t.body.scrollLeft:t.documentElement&&t.documentElement.scrollLeft&&(i=t.documentElement.scrollLeft),i},Sys.Extended.UI.HtmlEditor.addFormOnSubmit=function(n,t){var i=window.theForm;window.theForm!=null&&typeof theForm!="undefined"&&((i.HtmlEditor_editPanels==null||typeof i.HtmlEditor_editPanels=="undefined")&&(i.originalOnSubmit_HtmlEditor=window.theForm.onsubmit,i.HtmlEditor_editPanels=[],window.theForm.onsubmit=Sys.Extended.UI.HtmlEditor.EditPanelsOnSubmit,window.__doPostBack!=null&&typeof __doPostBack!="undefined"&&(window.__doPostBack_HtmlEditor_original==null||typeof __doPostBack_HtmlEditor_original=="undefined")&&(window.__doPostBack_HtmlEditor_original=window.__doPostBack,window.__doPostBack=Sys.Extended.UI.HtmlEditor.EditPanelsOnPostBack),window.ValidatorGetValue!=null&&typeof ValidatorGetValue!="undefined"&&(window.ValidatorGetValue_HtmlEditor_original==null||typeof ValidatorGetValue_HtmlEditor_original=="undefined")&&(window.ValidatorGetValue_HtmlEditor_original=window.ValidatorGetValue,window.ValidatorGetValue=Sys.Extended.UI.HtmlEditor.ValidatorGetValue)),i.HtmlEditor_editPanels.push({handler:n,editPanel:t}))},Sys.Extended.UI.HtmlEditor.removeFormOnSubmit=function(n){var t=window.theForm,f,r,i,u;if(window.theForm!=null&&typeof theForm!="undefined"&&(f=t.originalOnSubmit_HtmlEditor,t.HtmlEditor_editPanels!=null&&typeof t.HtmlEditor_editPanels!="undefined")){for(r=[],i=0;i<t.HtmlEditor_editPanels.length;i++)u=t.HtmlEditor_editPanels[i],u.handler!=n&&r.push(u);t.HtmlEditor_editPanels=r;t.HtmlEditor_editPanels.length==0&&(window.theForm.onsubmit=f,t.originalOnSubmit_HtmlEditor=null,t.HtmlEditor_editPanels=null,window.__doPostBack_HtmlEditor_original!=null&&typeof __doPostBack_HtmlEditor_original!="undefined"&&(window.__doPostBack=window.__doPostBack_HtmlEditor_original,window.__doPostBack_HtmlEditor_original=null),window.ValidatorGetValue_HtmlEditor_original!=null&&typeof ValidatorGetValue_HtmlEditor_original!="undefined"&&(window.ValidatorGetValue=window.ValidatorGetValue_HtmlEditor_original,window.ValidatorGetValue_HtmlEditor_original=null))}},Sys.Extended.UI.HtmlEditor.EditPanelsOnSubmit=function(n){for(var t=window.theForm,r=!0,i=0;i<t.HtmlEditor_editPanels.length;i++)if(r=t.HtmlEditor_editPanels[i].handler(n),!r)break;if(r&&t.originalOnSubmit_HtmlEditor!=null&&typeof t.originalOnSubmit_HtmlEditor!="undefined"&&(r=t.originalOnSubmit_HtmlEditor(n)),!r||!window.Page_IsValid)for(i=0;i<t.HtmlEditor_editPanels.length;i++)t.HtmlEditor_editPanels[i].editPanel._contentPrepared=!1;return r},Sys.Extended.UI.HtmlEditor.ValidatorGetValue=function(n){var i=$find(n),t,r;return i!=null&&(t=null,Sys.Extended.UI.HtmlEditor.Editor.isInstanceOfType(i)?t=i.get_editPanel():Sys.Extended.UI.HtmlEditor.EditPanel.isInstanceOfType(i)&&(t=i),t!=null)?(r=t._contentForValidation,(r==null||typeof r=="undefined")&&(r=t.get_content()),r):window.ValidatorGetValue_HtmlEditor_original(n)},Sys.Extended.UI.HtmlEditor.EditPanelsOnPostBack=function(n,t){for(var u,r=window.theForm,i=0;i<r.HtmlEditor_editPanels.length;i++)if(u=r.HtmlEditor_editPanels[i].handler(null),!u)return!1;return window.__doPostBack_HtmlEditor_original!=null&&typeof __doPostBack_HtmlEditor_original!="undefined"?window.__doPostBack_HtmlEditor_original(n,t):!0},Sys.Extended.UI.HtmlEditor.getRealAttributeIE=function(n,t,i){function f(n,t){r=t}var u=i,r="";return n.outerHTML.replace(new RegExp("^(?:<[^>]*?"+t+'=")([^"]*?)"',"ig"),f),r==""&&n.outerHTML.replace(new RegExp("^(?:<[^>]*?"+t+"=')([^']*?)'","ig"),f),r==""&&n.outerHTML.replace(new RegExp("^(?:<[^>]*?"+t+"=)([^s>]*?)","ig"),f),u!=r&&r!=""&&(u=r,u=u.replace(/&amp;/g,"&")),u},Sys.Extended.UI.HtmlEditor.getRealAttribute=function(n,t){var e=t.toLowerCase(),f=n.attributes,r="",u,t;for(i=0;i<f.length;++i)if((u=f.item(i),u.specified)&&(t=u.name.toLowerCase(),t==e)){r=u.value;Sys.Extended.UI.HtmlEditor.isIE&&(r=Sys.Extended.UI.HtmlEditor.getRealAttributeIE(n,t,r));(t=="src"||t=="href")&&(r=r.replace(/(\(S\([A-Za-z0-9_]+\)\)\/)/,""));break}return r},Sys.Extended.UI.HtmlEditor.enabledWordTags=["img","strong","p","b","i","u","a","h1","h2","h3","h4","h5","h6","table","tbody","tr","td","ul","ol","li","span","div","font","xml","del","ins","em","sub","sup","hr","br"],Sys.Extended.UI.HtmlEditor.cleanUp=function(n){function u(n){for(var t,f,e,o,c,s,a,h=n.childNodes.length,i=0;i<n.childNodes.length;i++)if(t=n.childNodes.item(i),t.nodeType==1)if(t.tagName.indexOf("/")>=0)i--,t.parentNode.removeChild(t);else{var r=t.tagName.toLowerCase(),l=!1,v=Sys.Extended.UI.HtmlEditor.enabledWordTags.length;for(f=0;f<v;f++)if(Sys.Extended.UI.HtmlEditor.enabledWordTags[f]==r){l=!0;break}if(u(t),l){e=t.style.backgroundColor;o=t.style.color;t.style.cssText="";t.removeAttribute("style");t.getAttribute("width")&&t.getAttribute("width").length>0&&(t.style.width=t.getAttribute("width"));t.width&&t.width.length>0&&(t.style.width=t.width);t.width="";try{t.removeAttribute("width")}catch(y){}t.getAttribute("height")&&t.getAttribute("height").length>0&&(t.style.height=t.getAttribute("height"));t.height&&t.height.length>0&&(t.style.height=t.height);t.height="";try{t.removeAttribute("height")}catch(y){}if(r=="table"&&(t.style.borderLeftWidth="1px",t.style.borderLeftColor="black",t.style.borderLeftStyle="solid",t.style.borderTopWidth="1px",t.style.borderTopColor="black",t.style.borderTopStyle="solid",t.style.backgroundColor=e,t.style.color=o),r=="td"&&(t.style.borderRightWidth="1px",t.style.borderRightColor="black",t.style.borderRightStyle="solid",t.style.borderBottomWidth="1px",t.style.borderBottomColor="black",t.style.borderBottomStyle="solid",t.style.backgroundColor=e,t.style.color=o),r=="font"||r=="span"){for(t.style.backgroundColor=e,t.style.color=o,c=t.attributes,h=0,s=0;s<c.length;++s)(a=c.item(s),a.specified)&&h++;if(h==0&&t.style.cssText==""){for(i+=t.childNodes.length;t.firstChild;)t.parentNode.insertBefore(t.firstChild,t);t.parentNode.removeChild(t);i--}}}else{for(i+=t.childNodes.length;t.firstChild;)t.parentNode.insertBefore(t.firstChild,t);t.parentNode.removeChild(t);i--}}}var r,t=Sys.Extended.UI.HtmlEditor.Trim(n.replace(/[\x00-\x1F]+/g," ")).replace(/^[^\u0000]+?<html(?:[^>]*?)>/gi,"").replace(/<\/html(?:[^>]*?)>[^\u0000]*$/gi,"").replace(/<head(?:[^>]*?)>[^\u0000]*?<\/head(?:[^>]*?)>/gi,"").replace(/<body[^>]*?>([^\u0000]*?)<\/body(?:[^>]*?)>/gi,"$1").replace(/<\/?html(?:[^>]*?)>/gi,"").replace(/<\/?head(?:[^>]*?)>/gi,"").replace(/<\/?body(?:[^>]*?)>/gi,"").replace(/<!--(\w|\W)+?-->/ig,"").replace(/(<[\/]?)(?:o|v|x|p|w|\?xml):(\w+)([^>]*?>)/ig,"$1$2$3").replace(/<(IMAGEDATA)([^>]*?)>/ig,"<img$2>").replace(/<p[^>]*><p>&nbsp;<\/p><\/p>/ig,"<br>").replace(/<p[^>]*?\/>/ig,"").replace(/<(p|div)[^>]*?>&nbsp;<\/(\1)[^>]*?>/ig,"").replace(/<(p|div)[^>]*?><\/(\1)[^>]*?>/ig,""),i;do r=t,t=t.replace(/<([^>]*)(?:class|size|lang|face|start|type|border|[ovwxp]:\w+)=(?:\'[^\']*\'|\"[^\"]*\"|[^> ]+)([^>]*)>/ig,"<$1$2>");while(t!=r);i=document.createElement("div");i.innerHTML=t;u(i);t=Sys.Extended.UI.HtmlEditor.Trim(i.innerHTML);delete i;t=t.replace(/<[\/]?(xml|del|ins)[^>]*?>/ig,"").replace(/<(p|div)[^>]*?>/ig,"").replace(/<\/(p|div)[^>]*?>/ig,"<br>");do r=t,t=t.replace(/<b><\/b>/ig,"").replace(/<i><\/i>/ig,"").replace(/<u><\/u>/ig,"").replace(/<strong><\/strong>/ig,"").replace(/<em><\/em>/ig,"").replace(/<sub><\/sub>/ig,"").replace(/<sup><\/sup>/ig,""),t=t.replace(/<span[^>]*?><\/span>/ig,"").replace(/<span>([^<]+?)<\/span>/ig,"$1"),t=t.replace(/<font[^>]*?><\/font>/ig,"").replace(/<font>([^<]+?)<\/font>/ig,"$1");while(t!=r);return t=t.replace(/&rsquo;/g,"'").replace(/&lsquo;/g,"'").replace(/&ndash;/g,"-").replace(/&mdash;/g,"-").replace(/&hellip;/g,"...").replace(/&quot;/g,'"').replace(/&ldquo;/g,'"').replace(/&rdquo;/g,'"').replace(//g,"").replace(/&bull;/g,"").replace(/[ \s]+/g," ").replace(/((&nbsp;)+)/g,"&nbsp;"),document.all&&(t=t.replace(/^[\x00-\x1F]*&nbsp;/,"")),t},Sys.Extended.UI.HtmlEditor.spanJoiner=function(n,t,i,r,u){var y=0,h=n.childNodes.length,c,f,p,w,v,o,b,e,l,s;for(typeof i!="undefined"&&i!=null&&(y=i),typeof r!="undefined"&&r!=null&&(h=r),c=y;c<h&&c<n.childNodes.length;c++)if(f=n.childNodes.item(c),f.parentNode==n)switch(f.nodeType){case 1:if(f.childNodes.length==0&&Sys.Extended.UI.HtmlEditor.isStyleTag(f.tagName)&&f.tagName.toUpperCase()!="A"&&!(f.className.length>0||f.getAttribute("class")&&f.getAttribute("class").length>0)&&!Sys.Extended.UI.HtmlEditor.isTempElement(f)){n.removeChild(f);c--;h--;continue}if(f.tagName.toUpperCase()=="SPAN"){while(f.childNodes.length==1&&f.firstChild.nodeType==1){if(f.firstChild.tagName.toUpperCase()!="SPAN"||Sys.Extended.UI.HtmlEditor.isTempElement(f.firstChild))f.firstChild.tagName.toUpperCase()=="SPAN"&&Sys.Extended.UI.HtmlEditor.isTempElement(f.firstChild)&&(w=f.firstChild,f.parentNode.insertBefore(f.firstChild,f),f.parentNode.removeChild(f),f=w);else{for(var l=Sys.Extended.UI.HtmlEditor.differAttr(f.firstChild,[]),s=Sys.Extended.UI.HtmlEditor.differStyle(f.firstChild),a=f.firstChild,k=a.childNodes;a.firstChild!=null;)f.insertBefore(a.firstChild,a);for(e=0;e<s.length;e++)if(s[e][1])try{if(f.style[s[e][0]])if(s[e][0].toLowerCase().indexOf("color")>=0)f.style[s[e][0]]=s[e][1];else try{p=f.style[s[e][0]];f.style[s[e][0]]=f.style[s[e][0]]+" "+s[e][1];p==f.style[s[e][0]]&&(f.style[s[e][0]]=s[e][1])}catch(d){f.style[s[e][0]]=s[e][1]}else f.style[s[e][0]]=s[e][1]}catch(g){}for(e=0;e<l.length;e++)l[e][1]&&f.setAttribute(l[e][0],l[e][1]);f.removeChild(a);continue}break}for(v=[],o=f.nextSibling;!Sys.Extended.UI.HtmlEditor.isTempElement(f)&&o&&c+1<h&&(o.nodeType==3||o.nodeType==1&&(o.tagName.toUpperCase()=="SPAN"||o.tagName.toUpperCase()=="BR"&&typeof u=="undefined")&&!Sys.Extended.UI.HtmlEditor.isTempElement(o));)if(o.nodeType==3)if((""+o.data+"").length==0)o.parentNode.removeChild(o),o=f.nextSibling,h--;else break;else if(o.tagName.toUpperCase()=="BR")v.push(o),o=o.nextSibling;else if(l=Sys.Extended.UI.HtmlEditor.differAttr(f,[],o),s=Sys.Extended.UI.HtmlEditor.differStyle(f,o),l.length==0&&s.length==0&&f.className==o.className){for(b=v.length,e=0;e<b;e++)f.appendChild(v[e]),h--;for(v=[];o.firstChild;)f.appendChild(o.firstChild);o.parentNode.removeChild(o);o=f.nextSibling;h--}else break;if(!Sys.Extended.UI.HtmlEditor.isTempElement(f)&&f.className.length==0&&(l=Sys.Extended.UI.HtmlEditor.differAttr(f,[]),s=Sys.Extended.UI.HtmlEditor.differStyle(f),l.length==0&&s.length==0)){for(c--,h--;f.firstChild;)f.parentNode.insertBefore(f.firstChild,f),h++;f.parentNode.removeChild(f);continue}}if(f.parentNode!=null)if(f.childNodes.length!=0||!Sys.Extended.UI.HtmlEditor.isStyleTag(f.tagName)||f.tagName.toUpperCase()=="A"||f.className.length>0||f.getAttribute("class")&&f.getAttribute("class").length>0||Sys.Extended.UI.HtmlEditor.isTempElement(f))Sys.Extended.UI.HtmlEditor.spanJoiner(f,t);else{n.removeChild(f);c--;h--;continue}}},Sys.Extended.UI.HtmlEditor._styleTags=["strong","em","u","strike","s","span","font","b","sub","sup","a","i"],Sys.Extended.UI.HtmlEditor.isStyleTag=function(n){if(!n)return!1;for(var t=0;t<Sys.Extended.UI.HtmlEditor._styleTags.length;t++)if(Sys.Extended.UI.HtmlEditor._styleTags[t].toLowerCase()==n.toLowerCase())return!0;return!1},Sys.Extended.UI.HtmlEditor.smartClassName="MSIEparagraph",Sys.Extended.UI.HtmlEditor.noContextMenuAttribute="obout-no-contextmenu",Sys.Extended.UI.HtmlEditor.isTempElement=function(n){return n.id&&n.id.length>0&&n.id.indexOf(Sys.Extended.UI.HtmlEditor.smartClassName)>=0?!0:!1},Sys.Extended.UI.HtmlEditor.differAttr=function(n,t,i){var s=[],u=n.parentNode,f,r,h,e,o;if(typeof i!="undefined"&&(u=i),u&&u.tagName&&Sys.Extended.UI.HtmlEditor.isStyleTag(u.tagName)||(u=null),n.attributes)for(f=0;f<n.attributes.length;f++){for(r=n.attributes[f],h=!1,e=0;e<t.length;e++)if(r.name.toUpperCase()==t[e].toUpperCase()){h=!0;break}if(!h&&r.name.toUpperCase()!="STYLE"&&r.name.toUpperCase().substr(0,4)!="_MOZ"&&r.specified)if(u&&u.attributes&&u.attributes[r.name])o=u.attributes[r.name],o&&(r.name!=o.name||r.value!=o.value)&&s.push([r.name,r.value]);else{if(r.name.toUpperCase()=="CLASS"&&r.value=="")continue;s.push([r.name,r.value])}}return s},Sys.Extended.UI.HtmlEditor.differStyle=function(n,t){function s(n,t){var r,i;if(t=""+t,n.toLowerCase()=="textdecoration")for(r=t.split(" "),i=0;i<r.length;i++)o.push([n,Sys.Extended.UI.HtmlEditor.Trim(r[i])]);else o.push([n,t])}var o=[],f=n.parentNode,r,i,u,e;typeof t!="undefined"&&(f=t);f&&f.tagName&&Sys.Extended.UI.HtmlEditor.isStyleTag(f.tagName)||(f=null);for(r in n.style)if(r&&typeof r=="string"&&r!="accelerator"){if(i=r,!isNaN(parseInt(r))){if(!Sys.Extended.UI.HtmlEditor.isSafari)continue;i=n.style[r]}u=n.style[i];u&&typeof u=="string"&&u!="accelerator"&&(f&&f.style?(e=f.style[i],i.toLowerCase()!="csstext"&&i.toLowerCase()!="length"&&u!=e&&s(i,u)):i.toLowerCase()!="csstext"&&i.toLowerCase()!="length"&&s(i,u))}if(typeof t!="undefined")for(r in f.style)if(r&&typeof r=="string"&&r!="accelerator"){if(i=r,!isNaN(parseInt(r))){if(!Sys.Extended.UI.HtmlEditor.isSafari)continue;i=n.style[r]}u=f.style[i];u&&typeof u=="string"&&u!="accelerator"&&(e=n.style[i],r.toLowerCase()!="csstext"&&i.toLowerCase()!="length"&&u!=e&&s(i,u))}return o},Sys.Extended.UI.HtmlEditor.brXHTML=function(n){return n.replace(/<br>/ig,"<br/>")},Sys.Extended.UI.HtmlEditor._needsClosingTag=function(n){return" script style div span a del strong em u strike font b sub sup p iframe li ul ol placeholder textarea td tr ".indexOf(" "+n.tagName.toLowerCase()+" ")!=-1},Sys.Extended.UI.HtmlEditor._encodeText_=function(n){return n.replace(/&/ig,"&amp;").replace(/</ig,"&lt;").replace(/>/ig,"&gt;").replace(/\"/ig,"&quot;").replace(/\xA0/ig,"&nbsp;")},Sys.Extended.UI.HtmlEditor._noNeedsClosingTag=function(n){return" hr br ".indexOf(" "+n.tagName.toLowerCase()+" ")!=-1},Sys.Extended.UI.HtmlEditor.canBeInsideP=function(n,t){var r,i;if(n&&n.style&&n.style.display&&n.style.display.toLowerCase()=="inline")return!0;if(r=n.tagName.toUpperCase(),r.length==2&&r.substr(0,1)=="H"&&parseInt(r.substr(1,1))>0)return!1;switch(r){case"TBODY":case"TR":case"TD":if(typeof t!="undefined"){for(i=n.parentNode;i&&i.tagName&&i.tagName.toUpperCase()!="TABLE";)i=i.parentNode;if(i.tagName.toUpperCase()=="TABLE"&&i.style&&i.style.display&&i.style.display.toLowerCase()=="inline")return!0}case"P":case"PRE":case"TABLE":case"OL":case"UL":case"LI":case"HR":case"DIV":case"BLOCKQUOTE":case"FORM":case"FIELDSET":case"LEGEND":return!1;default:return!0}},Sys.Extended.UI.HtmlEditor.convertAlign=function(n){var t,i;try{i=parseInt(n)-1}catch(r){return n}switch(i){case 1:t="left";break;case 2:t="right";break;case 3:t="texttop";break;case 4:t="absmiddle";break;case 5:t="baseline";break;case 6:t="absbottom";break;case 7:t="bottom";break;case 8:t="middle";break;case 9:t="top";break;default:t=n.replace(/\"/g,"&quot;")}return t},Sys.Extended.UI.HtmlEditor.getHTML=function(n,t,i){try{if(typeof i=="undefined")if(t||n.nodeType!=1){if(t&&n.nodeType==1&&Sys.Extended.UI.HtmlEditor.isIE)return n.outerHTML}else return n.innerHTML}catch(u){}var r=new Sys.Extended.UI.HtmlEditor.jsDocument(!0);return Sys.Extended.UI.HtmlEditor._getHTML_(r,n,t),r.toString()},Sys.Extended.UI.HtmlEditor._getHTML_=function(n,t,i){var h,l,y,e,f,p,c,w,b,v,a,u,o,r,k,s;switch(t.nodeType){case 1:case 11:if(t.tagName&&t.tagName.indexOf("/")>=0){if(Sys.Extended.UI.HtmlEditor.isIE){if(f=t.tagName.toLowerCase().substr(t.tagName.indexOf("/")+1),h=t.previousSibling,f=="embed")return;while(h!=null){if(h.nodeType==t.nodeType&&h.tagName&&h.tagName.toLowerCase()==f){n.append("<\/teo"+Sys.Extended.UI.HtmlEditor.smartClassName+":"+t.tagName.toLowerCase().substr(t.tagName.indexOf("/")+1)+">");return}h=h.previousSibling}}return}if(i&&t.tagName.length>0){if(f=t.tagName.toLowerCase(),l=!(t.hasChildNodes()||Sys.Extended.UI.HtmlEditor._needsClosingTag(t)),y=!0,p="",Sys.Extended.UI.HtmlEditor.isIE&&t.scopeName&&typeof t.scopeName!="undefined"&&(p=t.scopeName.toUpperCase()=="HTML"?"":t.scopeName+":"),Sys.Extended.UI.HtmlEditor.isIE&&(l||f=="placeholder")&&!Sys.Extended.UI.HtmlEditor._noNeedsClosingTag(t)&&f!="embed")for(c=t.nextSibling;c!=null;){if(c.nodeType==t.nodeType&&c.tagName&&(w=c.tagName,w.indexOf("/")>=0&&w.toLowerCase().substr(w.indexOf("/")+1)==f)){l=!1;y=!1;break}c=c.nextSibling}for(Sys.Extended.UI.HtmlEditor.canBeInsideP(t)||n.append("\n"),n.append("<"+(!l&&!y?"teo"+Sys.Extended.UI.HtmlEditor.smartClassName+":":p)+f),Sys.Extended.UI.HtmlEditor.isIE&&t.name&&t.name.length>0&&n.append(' name="'+t.name.replace(/\"/g,"&quot;")+'"'),Sys.Extended.UI.HtmlEditor.isIE&&t.value&&t.value.length>0&&f!="textarea"&&n.append(' value="'+t.value.replace(/\"/g,"&quot;")+'"'),Sys.Extended.UI.HtmlEditor.isIE&&t.className&&t.className.length>0&&n.append(' class="'+t.className.replace(/\"/g,"&quot;")+'"'),Sys.Extended.UI.HtmlEditor.isIE&&t.align&&t.align.length>0&&n.append(' align="'+t.align.replace(/\"/g,"&quot;")+'"'),Sys.Extended.UI.HtmlEditor.isIE&&t.color&&t.color.length>0&&n.append(' color="'+t.color.replace(/\"/g,"&quot;")+'"'),Sys.Extended.UI.HtmlEditor.isIE&&t.size&&t.size.length>0&&t.size!="+0"&&n.append(' size="'+t.size.replace(/\"/g,"&quot;")+'"'),Sys.Extended.UI.HtmlEditor.isIE&&t.shape&&t.shape.length>0&&n.write(' shape="'+t.shape.replace(/\"/g,"&quot;")+'"'),Sys.Extended.UI.HtmlEditor.isIE&&t.coords&&t.coords.length>0&&n.write(' coords="'+t.coords.replace(/\"/g,"&quot;")+'"'),b=t.attributes,v=null,e=0;e<b.length;++e)if((a=b.item(e),a.specified)&&(u=a.name.toLowerCase(),u.substr(0,4)!="_moz")&&u!="teoalign"){if(u!="style")if(u=="width")r=t.width,Sys.Extended.UI.HtmlEditor.isIE&&r==0&&(o=0,t.outerHTML.replace(new RegExp("^(?:<[^>]*?width=)([\\d]+)","ig"),function(n,t){o=t}),r!=o&&(r=o));else if(u=="height")r=t.height,Sys.Extended.UI.HtmlEditor.isIE&&r==0&&(o=0,t.outerHTML.replace(new RegExp("^(?:<[^>]*?height=)([\\d]+)","ig"),function(n,t){o=t}),r!=o&&(r=o));else if(Sys.Extended.UI.HtmlEditor.isIE&&u=="name"&&t.name&&t.name.length>0)continue;else if(Sys.Extended.UI.HtmlEditor.isIE&&u=="value"&&t.value&&t.value.length>0)continue;else if(Sys.Extended.UI.HtmlEditor.isIE&&u=="align"&&t.align&&t.align.length>0)continue;else if(Sys.Extended.UI.HtmlEditor.isIE&&u=="class"&&t.className&&t.className.length>0)continue;else if(Sys.Extended.UI.HtmlEditor.isIE&&u=="color"&&t.color&&t.color.length>0)continue;else if(Sys.Extended.UI.HtmlEditor.isIE&&u=="size"&&t.size&&t.size.length>0)continue;else if(Sys.Extended.UI.HtmlEditor.isIE&&u=="shape"&&t.shape&&t.shape.length>0)continue;else if(Sys.Extended.UI.HtmlEditor.isIE&&u=="coords"&&t.coords&&t.coords.length>0)continue;else if(f=="embed"&&u=="align"&&Sys.Extended.UI.HtmlEditor.isIE)r=Sys.Extended.UI.HtmlEditor.convertAlign(a.value);else{if(r=a.value,Sys.Extended.UI.HtmlEditor.isSafari&&u=="class"&&/apple-style/ig.test(r))continue;(u=="src"||u=="href")&&(Sys.Extended.UI.HtmlEditor.isIE&&(r=Sys.Extended.UI.HtmlEditor.getRealAttributeIE(t,u,r)),r=r.replace(/(\(S\([A-Za-z0-9_]+\)\)\/)/,""));r=r.replace(/\"/g,"&quot;")}else{Sys.Extended.UI.HtmlEditor.isSafari&&(v=a.value);continue}s='"';(""+r+"").indexOf('"')>=0&&(s="'");u!=null&&n.append(" "+u+"="+s+r+s)}if(t.style.cssText.length>0||v!=null){var u="style",d=/(url\((?:[^\)]*)\))/ig,g=[];function nt(n,t){g.push(t)}r=(v!=null?v:t.style.cssText).toLowerCase();r.replace(d,nt);k=0;function tt(){var n=g[k];return k++,n}if(r=Sys.Extended.UI.HtmlEditor.tryReplaceRgb(r.replace(d,tt)).replace(/(font-weight\s*:\s*)(700)/ig,"$1bold").replace(/([\s]*-moz-[^;]*[;][\s]*)/ig,"").replace(/(-moz-.*)$/i,"").replace(/(background-position: 0% 0%[;]*[\s]*)/ig,""),Sys.Extended.UI.HtmlEditor.isSafari){function it(n,t,i,r){return t+i.replace(/(,)/g,"")+r}r=r.replace(/(text-decoration:)([^;$]+)([;$])/ig,it)}if(Sys.Extended.UI.HtmlEditor.isSafari||Sys.Extended.UI.HtmlEditor.isOpera){function rt(n,t,i,r){return t+i.replace(/(['"])/g,"")+r}r=r.replace(/(font-family:)([^;]+)([;]*)/ig,rt)}r.length>0&&(s='"',(""+r+"").indexOf('"')>=0&&(s="'"),n.append(" "+u+"="+s+r+s))}n.append(l?" />":">");f=="br"&&n.append("\n")}if(t.tagName&&t.tagName.toUpperCase()=="SCRIPT"&&n.append(t.text),t.tagName&&t.tagName.toUpperCase()=="STYLE")n.append(t.innerHTML);else for(e=t.firstChild;e;e=e.nextSibling)Sys.Extended.UI.HtmlEditor._getHTML_(n,e,!0);i&&t.tagName.length>0&&!l&&y&&n.append("<\/"+p+t.tagName.toLowerCase()+">");break;case 3:n.append(Sys.Extended.UI.HtmlEditor._encodeText_(""+t.data+""));break;case 8:t.length>0?n.append("<!--"+t.data+"-->"):n.append("<!---->")}},Sys.Extended.UI.HtmlEditor.RemoveContextMenu=function(){var n=this,t=n._contextElement.parentNode.removeChild(n._contextElement);t&&delete t;n._contextElement=null;n._contextTable=null;n.__saved_range__&&(n.__saved_range__.select(),n.__saved_range__=null)},Sys.Extended.UI.HtmlEditor.contentEditable=function(n,t){for(var i,r;n!=null;){try{if(i=null,n.contentEditable==null||typeof n.contentEditable=="undefined"||Sys.Extended.UI.HtmlEditor.isSafari||Sys.Extended.UI.HtmlEditor.isOpera?(r=n.getAttribute("contenteditable"),typeof r=="boolean"?i=r:typeof r=="string"&&r.toLowerCase()=="false"&&(i=!1)):i=n.contentEditable&&n.contentEditable!="false"?!0:!1,i!=null&&typeof i=="boolean"&&!i)return n}catch(u){}if(typeof t!="undefined"&&t)return null;if(n.tagName!=null&&typeof n.tagName!="undefined"&&(n.tagName.toUpperCase()=="BODY"||n.tagName.toUpperCase()=="HTML"))break;n=n.parentNode}return null},Sys.Extended.UI.HtmlEditor.getSelParent=function(n){var r=n._getSelection(),i=n._createRange(r),t=null,u;return Sys.Extended.UI.HtmlEditor.isIE?t=r.type.toLowerCase()=="control"?i.item(0):n._getParent(i):(t=n._getParent(i),t.nodeType!=3&&i.startContainer==i.endContainer&&(u=t,t=t.childNodes.item(i.startOffset),t==null&&(t=u))),t},Sys.Extended.UI.HtmlEditor.__getIndex=function(n){var t=0;if(n.parentNode)for(;t<n.parentNode.childNodes.length;t++)if(n.parentNode.childNodes.item(t)==n)break;return t},Sys.Extended.UI.HtmlEditor.isInlineElement=function(n){if(n.nodeType==3)return!0;if(n.nodeType!=1||!n.tagName||n.tagName.length==0)return!1;if(n&&n.style&&n.style.display&&n.style.display.toLowerCase()=="inline")return!0;var t=n.tagName.toUpperCase();if(t.length==2&&t.substr(0,1)=="H"&&parseInt(t.substr(1,1))>0)return!1;switch(t){case"BR":case"TBODY":case"TR":case"TD":case"P":case"PRE":case"TABLE":case"OL":case"UL":case"LI":case"HR":case"DIV":case"BLOCKQUOTE":case"FORM":case"FIELDSET":case"LEGEND":return!1;default:return!0}},Sys.Extended.UI.HtmlEditor.capLock=function(n){var t=n.charCode,i=n.shiftKey?n.shiftKey:t==16?!0:!1;return t>=65&&t<=90&&!i||t>=97&&t<=122&&i?!0:!1},Sys.Extended.UI.HtmlEditor.operateAnchors=function(n,t,i){for(var r,e,o,u,f,h=t.getElementsByTagName("A"),c=!1,s=0;s<h.length;s++)if(r=h[s],r.name&&r.name.length>0){for(e=[],o=0;o<r.childNodes.length;o++)u=r.childNodes.item(o),u.nodeType==1&&u.tagName&&u.tagName.toUpperCase()=="IMG"&&u.src==n._editPanel.get_imagePath_anchor()&&(e.push(u),c=!0);while(e.length>0)r.removeChild(e.pop());i||(f=t.createElement("IMG"),f.title=r.name,f.src=n._editPanel.get_imagePath_anchor(),f.setAttribute(n.noContextMenuAttributeName(),"yes"),r.appendChild(f))}return c},Sys.Extended.UI.HtmlEditor.operatePlaceHolders=function(n,t,i){var v=!1,c,l,o,e,f,r,u,a,s,h;if(i){for(e=t.getElementsByTagName("IMG"),f=[],r=0;r<e.length;r++)f.push(e[r]);for(r=0;r<f.length;r++)u=f[r],c=u.getAttribute("dummytag"),c&&c.length>0&&c.toLowerCase()=="placeholder"&&(l=t.createElement("PLACEHOLDER"),o=u.title,(o==null||typeof o=="undefined")&&(o=u.getAttribute("title")),l.name=o,l.setAttribute("name",o),u.parentNode.insertBefore(l,u),u.parentNode.removeChild(u),v=!0)}else{for(e=t.getElementsByTagName("PLACEHOLDER"),f=[],r=0;r<e.length;r++)f.push(e[r]);for(r=0;r<f.length;r++){u=f[r];a=!0;try{u.childNodes.length>0&&(a=!1)}catch(y){}a&&(s=u.name,(s==null||typeof s=="undefined")&&(s=u.getAttribute("name")),h=t.createElement("IMG"),h.title=s,h.src=n._editPanel.get_imagePath_placeHolder(),h.setAttribute("dummytag","placeholder"),h.setAttribute("title",s),u.parentNode.insertBefore(h,u),u.parentNode.removeChild(u))}}return v},Sys.Extended.UI.HtmlEditor.inspectForShadows=function(n){for(var i=n.getElementsByTagName("IMG"),t=0;t<i.length;t++)if(i[t].getAttribute(Sys.Extended.UI.HtmlEditor.attachedIdAttribute)&&i[t].getAttribute(Sys.Extended.UI.HtmlEditor.attachedIdAttribute).length>0){try{Sys.Extended.UI.HtmlEditor.isIE?$removeHandler(i[t],"dragstart",Sys.Extended.UI.HtmlEditor.stopDrag):$removeHandler(i[t],"draggesture",Sys.Extended.UI.HtmlEditor.stopDrag)}catch(r){}Sys.Extended.UI.HtmlEditor.isIE?$addHandler(i[t],"dragstart",Sys.Extended.UI.HtmlEditor.stopDrag):$addHandler(i[t],"draggesture",Sys.Extended.UI.HtmlEditor.stopDrag)}},Sys.Extended.UI.HtmlEditor.attachedIdAttribute="obout-attached-id",Sys.Extended.UI.HtmlEditor.stopDrag=function(n){return n&&n.stopPropagation(),n.preventDefault(),!1},Sys.Extended.UI.HtmlEditor.replacingRules=[["strong","font-weight","bold"],["b","font-weight","bold"],["strong","font-weight","700"],["em","font-style","italic"],["i","font-style","italic"],["u","text-decoration","underline"],["strike","text-decoration","line-through"]],Sys.Extended.UI.HtmlEditor.replaceOldTags=function(n,t){for(var a,o,i,f,s,r,h,e,c=n.innerHTML,l=!1,u=0;u<Sys.Extended.UI.HtmlEditor.replacingRules.length;u++)if(a=new RegExp("<"+Sys.Extended.UI.HtmlEditor.replacingRules[u][0]+"[s>]","ig"),a.test(c)){l=!0;break}if(l||/<font[\s>]/ig.test(c))for(o=0;o<n.childNodes.length;o++)if(i=n.childNodes.item(o),i.nodeType==1){for(f=null,s=i.tagName.toLowerCase(),u=0;u<Sys.Extended.UI.HtmlEditor.replacingRules.length;u++)if(Sys.Extended.UI.HtmlEditor.replacingRules[u][0].toLowerCase()==s){f=Sys.Extended.UI.HtmlEditor.replacingRules[u];break}if(f){for(r=t._doc.createElement("SPAN"),r.style.cssText=i.style.cssText,Sys.Extended.UI.HtmlEditor.isIE?r.style[f[1]]=f[2]:r.style[f[1].replace(/\-(\w)/g,function(n,t){return t.toUpperCase()})]=f[2];i.firstChild;)r.appendChild(i.firstChild);n.insertBefore(r,i);n.removeChild(i);i=r}else if(s=="font"){for(r=t._doc.createElement("SPAN"),h=i.size,r.style.cssText=i.style.cssText,i.color&&(r.style.color=i.color),i.face&&(r.style.fontFamily=i.face);i.firstChild;)r.appendChild(i.firstChild);if(n.insertBefore(r,i),n.removeChild(i),h)if(e=t._doc.createElement("FONT"),e.size=h,n.insertBefore(e,r),r.style.cssText.length>0)e.appendChild(r),i=r;else{while(r.firstChild)e.appendChild(r.firstChild);n.removeChild(r);i=e}else i=r}Sys.Extended.UI.HtmlEditor.replaceOldTags(i,t)}},Sys.Extended.UI.HtmlEditor.getStyle=function(n,t){var i="";if(n.nodeType==1)if(n.ownerDocument&&n.ownerDocument.defaultView&&n.ownerDocument.defaultView.getComputedStyle)i=n.ownerDocument.defaultView.getComputedStyle(n,"").getPropertyValue(t);else if(n.currentStyle)try{t=t.replace(/\-(\w)/g,function(n,t){return t.toUpperCase()});i=n.currentStyle[t]}catch(r){i=n.style[t]}else i=n.style[t];return i},Sys.Extended.UI.HtmlEditor._Marker=function(n,t,i){var r,u;if(Sys.Extended.UI.HtmlEditor.isIE)if(this._nArr=Sys.Extended.UI.HtmlEditor.getNames(n._doc.body),this._save=n._doc.body.innerHTML,this._tree=null,i.type.toLowerCase()=="control")try{for(r=t.item(0),this._tree=[];r&&(r.nodeType==3||!r.tagName||r.tagName.toUpperCase()!="BODY");){for(u=0;r.previousSibling;)u++,r=r.previousSibling;this._tree.push(u);r=r.parentNode}}catch(f){}else this._offsetLeft=t.offsetLeft,this._offsetTop=t.offsetTop;else{this._save=Sys.Extended.UI.HtmlEditor.isOpera?Sys.Extended.UI.HtmlEditor.Trim(n._doc.body.innerHTML):n._doc.body.cloneNode(!0);this._tree=[];this._offset=0;try{for(r=t.startContainer,this._offset=t.startOffset,r&&r.nodeType==1&&r.tagName.toUpperCase()=="HTML"&&(r=n._doc.body,setTimeout(function(){try{i=n._getSelection();t=n._createRange();n._removeAllRanges(i);t.setStart(r,0);t.setEnd(r,0);n._selectRange(i,t)}catch(u){}},0));r&&r.nodeType&&(r.nodeType==3||!r.tagName||r.tagName.toUpperCase()!="BODY");){for(u=0;r.previousSibling;)u++,Sys.Extended.UI.HtmlEditor.isOpera&&r.nodeType==3&&r.previousSibling!=null&&r.previousSibling.nodeType==3&&u--,r=r.previousSibling;this._tree.push(u);r=r.parentNode}}catch(f){}}},Sys.Extended.UI.HtmlEditor.__stackMaxSize=30,Sys.Extended.UI.HtmlEditor.getNames=function(n){for(var t,i,f=n.all,e=[],o=[],u=0;u<f.length;u++)if(t=f[u],t.name&&t.name.length>0){var r=t.tagName,s=n.getElementsByTagName(r),h=0;for(i=0;i<s.length;i++)if(s[i]==t){h=i;break}o[r]=h;e.push([r,o[r],t.name])}return e},Sys.Extended.UI.HtmlEditor.setNames=function(n,t){for(var i=0;i<t.length;i++)n.getElementsByTagName(t[i][0]).length>t[i][1]&&(n.getElementsByTagName(t[i][0])[t[i][1]].name=t[i][2])},Sys.Extended.UI.HtmlEditor._lookChild=function(n,t){for(var r,i=0;i<n.childNodes.length;i++)if((r=n.childNodes.item(i),r==t)||r.nodeType==1&&Sys.Extended.UI.HtmlEditor._lookChild(r,t)>=0)return i;return-1},Sys.Extended.UI.HtmlEditor.getHrefsText=function(n){function i(n,i,r,u,f,e){for(var s=i.replace(/^<([^\s>]+)/,"$1"),h=!0,o=0;o<t.length;o++)if(t[o][0]==s){h=!1;break}h&&(t[o]=[s]);t[o].push(e)}var t=[],r=new RegExp("(<[^\\s><]+)([^><]*?)(href=)(\"|')([^\\4]*?)(\\4)((?:[^><]*?)>)","ig");return n.replace(r,i),t},Sys.Extended.UI.HtmlEditor.setHrefsText=function(n,t){for(var u,f,r,e,i=0;i<t.length;i++)for(u=n.getElementsByTagName(t[i][0]),f=1,r=0;r<u.length;r++)u[r].href&&(t[i][f]&&t[i][f].length>0&&(Sys.Extended.UI.HtmlEditor.isIE&&(e=u[r].innerHTML),u[r].href=t[i][f].replace(/&amp;/ig,"&"),Sys.Extended.UI.HtmlEditor.isIE&&(u[r].innerHTML=e)),f++)},Sys.Extended.UI.HtmlEditor.getImagesText=function(n){function i(n,i,r,u){return t.push(u),n}var t=[];return n.replace(/(<img(?:.*?))(src=")(.*?)(")((?:.*?)>)/ig,i),t},Sys.Extended.UI.HtmlEditor.setImagesText=function(n,t){for(var u=n.getElementsByTagName("IMG"),i=0,r=0;r<u.length;r++)u[r].src&&(t[i]&&t[i].length>0&&(u[r].src=t[i].replace(/&amp;/ig,"&")),i++)},Sys.Extended.UI.HtmlEditor.canHaveChildren=function(n){return Sys.Extended.UI.HtmlEditor.isIE?n.canHaveChildren:!/^(area|base|basefont|col|frame|hr|img|br|input|isindex|link|meta|param)$/.test(n.tagName.toLowerCase())},Sys.Extended.UI.HtmlEditor._setCursor=function(n,t){var r=n,e,f,u,i;if(Sys.Extended.UI.HtmlEditor.isIE){u=t._getSelection();i=t._createRange(u);u.type.toLowerCase()=="control"&&(i.remove(0),u.empty(),i=t._createRange());e=r.nodeType==3;e&&(f=t._doc.createElement("SPAN"),f.innerHTML="&nbsp;",r.parentNode.insertBefore(f,r),r=f);var o=$common.getLocation(r),s=o.x,h=o.y;e&&f.parentNode.removeChild(f);try{i.moveToPoint(s,h)}catch(c){}i.select()}else u=t._getSelection(),i=t._createRange(),i.setStart(r,0),i.setEnd(r,0),t._removeAllRanges(u),t._selectRange(u,i),t.focusEditor()},Sys.Extended.UI.HtmlEditor.myClone=function(n,t,i){var r,u;if(Sys.Extended.UI.HtmlEditor.isIE&&n.tagName&&(n.tagName.toUpperCase()=="EMBED"||n.tagName.toUpperCase()=="OBJECT")){u=t.createElement("DIV");try{u.innerHTML=n.outerHTML;r=u.firstChild}catch(f){r=n}delete u}else r=n.cloneNode(i);return r},Sys.Extended.UI.HtmlEditor.unStyle=function(n){var t=n.parentNode!=null&&typeof n.parentNode!="undefined"?n.parentNode:null,i,s,r;if(t){for(i=null;t&&t.tagName&&t.tagName.toUpperCase()!="BODY"&&Sys.Extended.UI.HtmlEditor.isStyleTag(t.tagName)&&t.tagName.toUpperCase()!="A";)i=t,t=t.parentNode;if(i){function o(n,t,r,u,f){var e=r.cloneNode(!1),h,v,l,c,a,s;if(n)if(n.push&&typeof n.push=="function")for(h=0;h<n.length;h++)e.appendChild(n[h]);else e.appendChild(n);if(f)e.appendChild(t);else while(t)v=u?t.previousSibling:t.nextSibling,(t.nodeType==1||t.nodeType==3&&Sys.Extended.UI.HtmlEditor.Trim(""+t.data+"").length>0)&&(t.nodeType==1&&t.tagName&&Sys.Extended.UI.HtmlEditor.isStyleTag(t.tagName)&&t.childNodes.length==0&&!Sys.Extended.UI.HtmlEditor.isTempElement(t)&&(t=null),t&&(e.childNodes.length!=0&&u?e.insertBefore(t,e.firstChild):e.appendChild(t))),t=v;if(e.childNodes.length==0)delete e,e=null;else if(e.childNodes.length==1&&e.firstChild.nodeType==3&&(""+e.firstChild.data+"").length==0)delete e,e=null;else if(!f&&e.tagName&&Sys.Extended.UI.HtmlEditor.isStyleTag(e.tagName)&&e.tagName.toUpperCase()!="A"&&!Sys.Extended.UI.HtmlEditor.isTempElement(e)){for(l=e.childNodes.length,c=0;c<e.childNodes.length;c++)s=e.childNodes.item(c),s.nodeType==1&&s.tagName&&!Sys.Extended.UI.HtmlEditor.isStyleTag(s.tagName)&&(s.tagName.toUpperCase()=="BR"||s.tagName.toUpperCase()=="TABLE"||Sys.Extended.UI.HtmlEditor.isTempElement(s))&&l--;if(l==0){for(a=[];e.firstChild;)s=e.removeChild(e.firstChild),a.push(s);e=a}}return r==i?e:f?o(null,e,r.parentNode,u,f):o(e,u?r.previousSibling:r.nextSibling,r.parentNode,u,f)}t=n.parentNode;n.previousSibling==null&&n.nextSibling==null&&t&&t.tagName&&t.tagName.toUpperCase()!="BODY"&&Sys.Extended.UI.HtmlEditor.isStyleTag(t.tagName)&&Sys.Extended.UI.HtmlEditor.differAttr(t,["class","color","face","size"]).length>0&&(n=t);var f=o(null,n.previousSibling,n.parentNode,!0,!1),e=o(null,n.nextSibling,n.parentNode,!1,!1),u=i.parentNode;if(f)if(f.push&&typeof f.push=="function")for(r=0;r<f.length;r++)u.insertBefore(f[r],i);else u.insertBefore(f,i);if(n.nodeType==1&&n.tagName&&(n.tagName.toUpperCase()=="BR"||n.tagName.toUpperCase()=="TABLE"||Sys.Extended.UI.HtmlEditor.isTempElement(n))?u.insertBefore(n,i):(s=o(null,n,n.parentNode,!1,!0),u.insertBefore(s,i)),e)if(e.push&&typeof e.push=="function")for(r=0;r<e.length;r++)u.insertBefore(e[r],i);else u.insertBefore(e,i);u.removeChild(i)}}},Sys.Extended.UI.HtmlEditor.isTempElement=function(n){return n.id&&n.id.length>0&&n.id.indexOf(Sys.Extended.UI.HtmlEditor.smartClassName)>=0?!0:!1},Sys.Extended.UI.HtmlEditor._moveTagsUp=function(n,t){function r(n){var t,i;if(Sys.Extended.UI.HtmlEditor.isInlineElement(n)&&n.nodeType!=3){if(n.tagName&&Sys.Extended.UI.HtmlEditor.isStyleTag(n.tagName)&&n.tagName.toUpperCase()!="A"&&!Sys.Extended.UI.HtmlEditor.isTempElement(n))for(t=n.firstChild;t!=null;)i=t.nextSibling,r(t),t=i}else Sys.Extended.UI.HtmlEditor.unStyle(n)}for(var i=n,u;i!=null&&i!=t;)u=i.nextSibling,r(i),i=u},Sys.Extended.UI.HtmlEditor._commonTotalParent=function(n,t){for(var i=n.parentNode,e=n,u,f,r;i;){if(i.tagName&&!Sys.Extended.UI.HtmlEditor.isStyleTag(i.tagName)&&(u=Sys.Extended.UI.HtmlEditor._lookChild(i,t),u>=0)){for(f=0,r=0;r<i.childNodes.length;r++)if(i.childNodes.item(r)==e){f=r;break}return{parent:i,indexFirst:f,indexLast:u}}e=i;i=i.parentNode}return null},Sys.Extended.UI.HtmlEditor._commonParent=function(n,t){for(var i=n.parentNode,e=n,u,f,r;i&&i.tagName.toUpperCase()!="BODY"&&Sys.Extended.UI.HtmlEditor.isStyleTag(i.tagName);){if(u=Sys.Extended.UI.HtmlEditor._lookChild(i,t),u>=0){for(f=0,r=0;r<i.childNodes.length;r++)if(i.childNodes.item(r)==e){f=r;break}return{parent:i,indexFirst:f,indexLast:u}}e=i;i=i.parentNode}return null},Sys.Extended.UI.HtmlEditor.positionInParagraph=function(n,t,i,r,u){for(;;){var f=Sys.Extended.UI.HtmlEditor.positionInParagraphLevel(n,t,i,u);if(f!=null)return f;if(r.tagName&&Sys.Extended.UI.HtmlEditor.isStyleTag(r.tagName)&&r.tagName.toUpperCase()!="A"&&!Sys.Extended.UI.HtmlEditor.isTempElement(r))t=i?r.previousSibling:r.nextSibling,r=r.parentNode;else return i&&r.firstChild!=null?r.insertBefore(n,r.firstChild):r.appendChild(n),n}},Sys.Extended.UI.HtmlEditor.positionInParagraphLevel=function(n,t,i,r){for(var s,u,e,f,h,o;t;){if(s=i?t.previousSibling:t.nextSibling,Sys.Extended.UI.HtmlEditor.isInlineElement(t)){if(typeof r=="function"&&t.nodeType==3){if(e=""+t.data+"",i){for(u=e.length-1;u>=0;u--)if(r(e.substr(u,1)))break}else for(u=0;u<e.length;u++)if(r(e.substr(u,1)))break;if(u>=0&&u<e.length)return f=t.parentNode,(u>0||i&&u==0)&&(u<e.length-1||!i&&u==e.length-1)?(h=i?t.splitText(u+1):t.splitText(u),f.insertBefore(n,h)):i?t.nextSibling?f.insertBefore(n,t.nextSibling):f.appendChild(n):f.insertBefore(n,t),n}}else return f=t.parentNode,i?t.nextSibling?f.insertBefore(n,t.nextSibling):f.appendChild(n):f.insertBefore(n,t),n;if(t=i?t.lastChild:t.firstChild,t&&(o=Sys.Extended.UI.HtmlEditor.positionInParagraphLevel(n,t,i,r),o!=null))return o;t=s}return null},Sys.Extended.UI.HtmlEditor._addEvent=function(n,t,i){n.attachEvent?n.attachEvent("on"+t,i):n.addEventListener&&n.addEventListener(t,i,!0)},Sys.Extended.UI.HtmlEditor._addEvents=function(n,t,i){for(var r=0;r<t.length;r++)Sys.Extended.UI.HtmlEditor._addEvent(n,t[r],i)},Sys.Extended.UI.HtmlEditor._removeEvent=function(n,t,i){n.detachEvent?n.detachEvent("on"+t,i):n.removeEventListener&&n.removeEventListener(t,i,!0)},Sys.Extended.UI.HtmlEditor._removeEvents=function(n,t,i){for(var r=0;r<t.length;r++)Sys.Extended.UI.HtmlEditor._removeEvent(n,t[r],i)},Sys.Extended.UI.HtmlEditor._stopEvent=function(n){n&&(Sys.Extended.UI.HtmlEditor.isIE?(n.cancelBubble=!0,n.returnValue=!1):(n.preventDefault(),n.stopPropagation()))},Sys.Extended.UI.HtmlEditor.restrictedTags=["DIV","P","TD","TR","TABLE","TBODY","LI","OL","UL","FORM","INPUT"],Sys.Extended.UI.HtmlEditor.isRestricted=function(n){for(var i=n.tagName.toUpperCase(),t=0;t<Sys.Extended.UI.HtmlEditor.restrictedTags.length;t++)if(Sys.Extended.UI.HtmlEditor.restrictedTags[t].toUpperCase()==i)return!0;return Sys.Extended.UI.HtmlEditor.isIE&&n.scopeName.toUpperCase()!="HTML"?!0:!1},Sys.Extended.UI.HtmlEditor.jsDocument=function(n){this.noExtraLf=typeof n!="undefined"&&n;this.text=[];this.write=function(n){(!this.noExtraLf||this.text.length==0&&n!="\n"||this.text.length>0&&(this.text[this.text.length-1]!="\n"||n!="\n"))&&(this.text[this.text.length]=n)};this.append=this.write;this.writeln=function(n){this.text[this.text.length]=n+"\n"};this.toString=function(){return this.text.join("")};this.clear=function(){delete this.text;this.text=null;this.text=[]}},Sys.Extended.UI.HtmlEditor.isHeader=function(n){var t=n.tagName.toUpperCase();return t.length==2&&t.substr(0,1)=="H"&&parseInt(t.substr(1,1))>0?!0:!1},Sys.Extended.UI.HtmlEditor._getReallyFirst=function(n){return typeof n.firstChild!="undefined"&&n.firstChild!=null&&typeof n.firstChild.childNodes!="undefined"&&n.firstChild.childNodes!=null?Sys.Extended.UI.HtmlEditor._getReallyFirst(n.firstChild):n},Sys.Extended.UI.HtmlEditor._getReallyLast=function(n){return typeof n.lastChild!="undefined"&&n.lastChild!=null&&typeof n.lastChild.childNodes!="undefined"&&n.lastChild.childNodes!=null?Sys.Extended.UI.HtmlEditor._getReallyLast(n.lastChild):n},Sys.Extended.UI.HtmlEditor._reallyFirst=function(n,t){if(n.firstChild){if(n.firstChild==t)return!0;if(n.firstChild.childNodes&&Sys.Extended.UI.HtmlEditor._lookChild(n.firstChild,t)==0)return Sys.Extended.UI.HtmlEditor._reallyFirst(n.firstChild,t)}return!1},Sys.Extended.UI.HtmlEditor._reallyLast=function(n,t){if(n.lastChild){if(n.lastChild==t)return!0;if(n.lastChild.childNodes&&Sys.Extended.UI.HtmlEditor._lookChild(n.lastChild,t)==n.lastChild.childNodes.length-1)return Sys.Extended.UI.HtmlEditor._reallyLast(n.lastChild,t)}return!1},Sys.Extended.UI.HtmlEditor.getContainer=function(n,t){var r,i,u;if(t==n)return n;if(n.nodeType==1)for(r=0;r<n.childNodes.length;r++){if(i=n.childNodes.item(r),t==i)return i;if(i.nodeType==1&&(u=Sys.Extended.UI.HtmlEditor._lookChild(i,t),u>=0))return i.tagName&&Sys.Extended.UI.HtmlEditor.isStyleTag(i.tagName)&&i.tagName.toUpperCase()!="A"&&!Sys.Extended.UI.HtmlEditor.isTempElement(i)?Sys.Extended.UI.HtmlEditor.getContainer(i,t):i}return null},Sys.Extended.UI.HtmlEditor._TryTransformFromPxToPt=function(n,t,i){var f=n.replace(/^(\d+)\.(\d+)px/i,"$1px"),e,o,r,s,u;if(!Sys.Extended.UI.HtmlEditor.isIE&&f&&f.length>0){if(e=f.toLowerCase().split(",")[0],typeof i!="undefined"&&(o=document.getElementById(i),o!=null)){for(r=0;r<o.options.length;r++)if(s=Sys.Extended.UI.HtmlEditor.fontSizeSeek(o.options.item(r).value.toLowerCase().split(",")[0]),s==e)break;if(r==o.options.length){for(u=t._doc.createElement("SPAN"),t._doc.body.appendChild(u),r=1;r<100;r++)if(u.style.fontSize=r+"pt",Sys.Extended.UI.HtmlEditor.getStyle(u,"font-size").replace(/^(\d+)\.(\d+)px/i,"$1px")==e){e=r+"pt";break}u.parentNode.removeChild(u)}}f=e}return f},Sys.Extended.UI.HtmlEditor.fontSizeSeek=function(n){var t=n.toString();switch(t){case"1":t="8pt";break;case"2":t="10pt";break;case"3":t="12pt";break;case"4":t="14pt";break;case"5":t="18pt";break;case"6":t="24pt";break;case"7":t="36pt"}return t},Sys.Extended.UI.HtmlEditor.getOwnerDocument=function(n){return n.nodeType==9?n:n.ownerDocument||n.document},Sys.Extended.UI.HtmlEditor.getClientViewportElement=function(n){var t;return(t=n.nodeType==9?n:Sys.Extended.UI.HtmlEditor.getOwnerDocument(n),Sys.Extended.UI.HtmlEditor.isIE&&t.compatMode!="CSS1Compat")?t.body:t.documentElement},Sys.Extended.UI.HtmlEditor.isReallyVisible=function(n){for(var t=n,i=!0;t;){if(t.style&&Sys.Extended.UI.HtmlEditor.getStyle(t,"display")=="none"){i=!1;break}t=t.parentNode}return i},Sys.Extended.UI.HtmlEditor.setSelectionRange=function(n,t,i){if(n.focus(),n.setSelectionRange)n.setSelectionRange(t,i);else if(n.createTextRange){var r=n.createTextRange();r.collapse(!0);r.moveEnd("character",i);r.moveStart("character",t);r.select()}},Sys.Extended.UI.HtmlEditor.setElementVisibility=function(n){for(var u=[],t=n,i,r;t&&t.nodeType==1&&t.tagName.toUpperCase()!="BODY";)i=t.style.display,r=t.style.visibility,t.style&&(i=="none"||r=="hidden")&&(u.push({element:t,display:i,visibility:r}),t.style.display="",t.style.visibility="visible"),t=t.parentNode;return u},Sys.Extended.UI.HtmlEditor.restoreElementVisibility=function(n){for(var i,r,t=0;t<n.length;t++)i=n[t],r=i.element.style,r.display=i.display,r.visibility=i.visibility},!Sys.Extended.UI.HtmlEditor.isIE)try{Sys.Extended.UI.HtmlEditor.__MozillaGetInnerText=function(n,t){for(var i,f,e,u=n.childNodes,r=0;r<u.length;r++)i=u[r],i.nodeType==3&&t.write(i.nodeValue.replace("\n","")),i.nodeType==1&&(f=Sys.Extended.UI.HtmlEditor.getStyle(i,"display"),e=Sys.Extended.UI.HtmlEditor.getStyle(i,"visibility"),Sys.Extended.UI.HtmlEditor.__needLineBreakBefore(i)&&t.write("\n"),Sys.Extended.UI.HtmlEditor.__needTabBefore(i)&&t.write("\t"),f!="none"&&e!="hidden"&&Sys.Extended.UI.HtmlEditor.__MozillaGetInnerText(i,t),Sys.Extended.UI.HtmlEditor.__needLineBreakAfter(i)&&t.write("\n"))};Sys.Extended.UI.HtmlEditor.__needLineBreakBefore=function(n){return" div table p pre ol ul blockquote form fieldset ".indexOf(" "+n.tagName.toLowerCase()+" ")!=-1};Sys.Extended.UI.HtmlEditor.__needLineBreakAfter=function(n){return" br div table tr p pre ol ul li hr blockquote form fieldset legend ".indexOf(" "+n.tagName.toLowerCase()+" ")!=-1};Sys.Extended.UI.HtmlEditor.__needTabBefore=function(n){return" td li ".indexOf(" "+n.tagName.toLowerCase()+" ")!=-1}}catch(ex){}
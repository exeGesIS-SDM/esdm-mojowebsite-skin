<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta name="apple-mobile-web-app-capable" content="yes">
	<style type="text/css">
        #map {
            width: 99%;
            height:550px;
            border: 2px solid gray;
        }
		body {
			padding:0px;
			margin:2px
		}
    </style>
	<script src="http://www.esdmdata.co.uk/ClientScript/OpenLayers-2.11/OpenLayers.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script>
	<link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.2/themes/base/jquery-ui.css" type="text/css" />
    <script type="text/javascript">
        var map, Aerials
		// a variable for each set of photography layer
		var AerialsBA, AerialsMR, AerialsCF, AerialsST, AerialsRA, AerialsOX;
		var maxOpacity = 1.0;
        var minOpacity = 0.0;
		var initialOpacity = 0.9;
		// the extent the user cannot pan beyond
		var extent = new OpenLayers.Bounds( 195000,192000,201000,199000);
        function init(){
            map = new OpenLayers.Map( {
				div: 'map',
                projection: new OpenLayers.Projection("EPSG:27700"),
			    units: "m",
			    maxExtent: new OpenLayers.Bounds(0,0,699904,1299968),
				//resolutions: [3000,2000,1000,500,250,150,100,50,25,12.5,5.000,2.500,1.000],
				resolutions: [25,12.5,5.000,2.500,1.000,0.5,0.25,0.125,0.0625,0.03125],
				restrictedExtent: extent,
			    controls: [new OpenLayers.Control.Navigation(),
			                             new OpenLayers.Control.PanZoomBar()]
                  }
            );
			
			// defined each set of photography as a layer
			
            AerialsMR = new OpenLayers.Layer.WMS(
                "Merthyr Photography",
                "http://www.esdmwms.no-ip.co.uk/scripts/mapserv.exe?map=D:\\Websites\\UKBaseMap\\map\\AerialPhotos.map",
				{layers: 'Merthyr Rising', transparent: true, format: 'image/png'},
                {singleTile: true, isBaseLayer: false, opacity: initialOpacity
				}
            );

			AerialsBA = new OpenLayers.Layer.TileCache( "Berners Allsop Photography",
                "http://www.esdmwms.no-ip.co.uk/scripts/tilecache/tilecache-2.11/Cache",
                "BernersAllsopOSGB", 
				{'format': 'image/png',
				isBaseLayer: false, 
				serverResolutions: [25,12.5,5,2.5,1,0.5,0.25,0.125,0.0625],
				opacity: initialOpacity
				}
            );
			
			AerialsCF = new OpenLayers.Layer.TileCache( "Cors Fochno Photography",
                "http://www.esdmwms.no-ip.co.uk/scripts/tilecache/tilecache-2.11/Cache",
                "corsfochnoOSGB", 
				{'format': 'image/png',
				isBaseLayer: false, 
				serverResolutions: [25,12.5,5,2.5,1,0.5,0.25,0.125,0.0625],
				opacity: initialOpacity
				}
            );
			AerialsST = new OpenLayers.Layer.TileCache( "Stackpole Photography",
                "http://www.esdmwms.no-ip.co.uk/scripts/tilecache/tilecache-2.11/Cache",
                "StackpoleOSGB", 
				{'format': 'image/png',
				isBaseLayer: false, 
				serverResolutions: [25,12.5,5,2.5,1,0.5,0.25,0.125,0.0625],
				opacity: initialOpacity
				}
            );
			AerialsRA = new OpenLayers.Layer.TileCache( "River Ashop Photography",
                "http://www.esdmwms.no-ip.co.uk/scripts/tilecache/tilecache-2.11/Cache",
                "RiverAshopOSGB", 
				{'format': 'image/png',
				isBaseLayer: false, 
				serverResolutions: [25,12.5,5,2.5,1,0.5,0.25,0.125,0.0625,0.03125],
				opacity: initialOpacity
				}
            );
			AerialsOX = new OpenLayers.Layer.TileCache( "Oxwich Photography",
                "http://www.esdmwms.no-ip.co.uk/scripts/tilecache/tilecache-2.11/Cache",
                "OxwichOSGB", 
				{'format': 'image/png',
				isBaseLayer: false, 
				serverResolutions: [25,12.5,5,2.5,1,0.5,0.25,0.125,0.0625,0.03125],
				opacity: initialOpacity
				}
            );
			
			
			// base mapping
			var OSOpen27700Cached = new OpenLayers.Layer.TileCache( "Ordnance Survey",
                "http://www.esdmwms.no-ip.co.uk/scripts/tilecache/tilecache-2.11/Cache",
                "OSOpen27700", 
				{'format': 'image/png',
				isBaseLayer: true, 
				serverResolutions: [3000,2000,1000,500,250,150,100,50,25,12.5,5.000,2.500,1.000]
				}
            );
			Aerials = AerialsST;
			// add default layers
            map.addLayers([OSOpen27700Cached, Aerials]);
			// set default centre
			//map.setCenter(new OpenLayers.LonLat(427400, 191600), 1);
			map.setCenter(new OpenLayers.LonLat(197000, 195500), 1);
            //map.addControl(new OpenLayers.Control.LayerSwitcher());
			map.addControl(new OpenLayers.Control.MousePosition());
			map.addControl(new OpenLayers.Control.Scale());
            map.addControl(new OpenLayers.Control.ScaleLine());
			
			$("#amount").val(initialOpacity);
        }
        OpenLayers.Util.onImageLoadError = function() {
            /**
             * For images that don't exist in the cache, you can display
             * a default image - one that looks like water for example.
             * To show nothing at all, leave the following lines commented out.
             */
            this.src = "http://www.esdmwms.no-ip.co.uk/map/blank256.png";
            this.style.display = "";
        };



		
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("#slider").slider({
				value: initialOpacity,
				min: minOpacity,
				max: maxOpacity,
				step: 0.01,
				animate: true,
                slide: function (event, ui) {
                    setOpacity(ui.value);
                }
            });
        });

        function setOpacity(value) {
            $("#amount").val(value);
			Aerials.setOpacity(value);
        }


		function setMap(whichMap) {
			//alert(whichMap);
			switch (whichMap)
			{
				case 'BA':
					//alert(whichMap);
					extent = new OpenLayers.Bounds( 425600,188800,428900,194200);
					map.setOptions({restrictedExtent: extent});
					//map.addLayer(AerialsBA);
					//map.removeLayer(AerialsMR);
					map.removeLayer(Aerials);
					Aerials = AerialsBA;
					map.addLayer(Aerials);
					Aerials.setOpacity($("#amount").val());
					map.setCenter(new OpenLayers.LonLat(427400, 191600), 1);
					break;
				case 'CF':
					//alert(whichMap);
					extent = new OpenLayers.Bounds( 259000,288000,267000,294000);
					map.setOptions({restrictedExtent: extent});
					//map.removeControl({OpenLayers.Control.Navigation()});
					//map.removeControl({OpenLayers.Control.PanZoomBar()});
					//map.setOptions({resolutions: [25,12.5,5.000,2.500,1.000,0.5,0.25,0.125,0.0625]});
					//alert('here');
					//map.addControl({OpenLayers.Control.Navigation()});
					//map.addControl({OpenLayers.Control.PanZoomBar()});
					map.removeLayer(Aerials);
					Aerials = AerialsCF;
					map.addLayer(Aerials);
					Aerials.setOpacity($("#amount").val());
					map.setCenter(new OpenLayers.LonLat(263400, 291200), 1);
					break;
				case 'ST':
					//alert(whichMap);
					extent = new OpenLayers.Bounds( 195000,192000,201000,199000);
					map.setOptions({restrictedExtent: extent});
					map.removeLayer(Aerials);
					Aerials = AerialsST;
					map.addLayer(Aerials);
					Aerials.setOpacity($("#amount").val());
					map.setCenter(new OpenLayers.LonLat(197000, 195500), 1);
					break;
				case 'RA':
					//alert(whichMap);
					extent = new OpenLayers.Bounds( 414300,389000,415100,389500);
					// no effect map.setOptions({resolutions: [25,12.5,5.000,2.500,1.000,0.5,0.25,0.125,0.0625,0.03125]});
					map.setOptions({restrictedExtent: extent});
					//map.setOptions({numZoomLevels: 9});
					map.removeLayer(Aerials);
					Aerials = AerialsRA;
					map.addLayer(Aerials);
					Aerials.setOpacity($("#amount").val());
					map.setCenter(new OpenLayers.LonLat(414700, 389250), 3);
					break;
				case 'OX':
					extent = new OpenLayers.Bounds( 249000,184500,253000,189000);
					map.setOptions({restrictedExtent: extent});
					map.removeLayer(Aerials);
					Aerials = AerialsOX;
					map.addLayer(Aerials);
					Aerials.setOpacity($("#amount").val());
					map.setCenter(new OpenLayers.LonLat(251075, 186675), 1);
			}
			
        }
		
	</script>
  </head>
  <body onload="init()">
  <form>
	<p style="margin-top: 0.2em; font-family: verdana; font-size:medium;">Select which sample area to view: 
	<br />
	<input type="radio" name="mapChoice" value="ST" checked onClick="setMap('ST')"/>Stackpole, Pembrokeshire (resolution 4.5cm/pixel*)
	<br />
	<!-- <input type="radio" name="mapChoice" value="BA" onClick="setMap('BA')"/>Farmland, nr Swindon (resolution 5cm/pixel*)
	<br /> -->
	<input type="radio" name="mapChoice" value="CF" onClick="setMap('CF')"/>Cors Fochno, Ceredigion (resolution 4.5cm/pixel*)
	<br />
	<input type="radio" name="mapChoice" value="RA" onClick="setMap('RA')"/>River Ashop, Derbyshire (resolution 2.0cm/pixel*)
<br />
	<input type="radio" name="mapChoice" value="OX" onClick="setMap('OX')"/>Oxwich Bay, Gower Peninsula (resolution 3.6cm per pixel*)
	</p>
		</form> 
    <div id="map"></div>

		<p style="margin-top: 0.2em; font-family: verdana; font-size:medium; float: left;">
			<label for="amount">Opacity of the aerial photographs:</label>
			<input type="text" id="amount" style="border:0; color:#f6931f; font-weight:bold; width: 4em;" />
		</p>

		<div id="slider" style="width: 160px;  float: left; margin-top: 0.3em;"></div>
<p style="margin-top: 0.2em; font-family: verdana; font-size:medium; float: left;">* Please note: these images are slightly degraded to permit fast serving in this web page. We can generate 3D images on request.</p>
  </body>
</html>


